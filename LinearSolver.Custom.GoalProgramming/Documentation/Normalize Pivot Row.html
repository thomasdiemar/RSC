<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Simplex — Normalize Pivot Row (Deep Dive)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --ink:#1f2328; --muted:#6b7280; --bg:#f7f9fb; --line:#e5e7eb;
    --pivot:#fff3b0; --pivot-b:#e0cc7a;     /* pivot element */
    --enter:#e6f0ff; --enter-b:#7aa2ff;     /* entering column */
    --obj:#e8f7e8; --obj-b:#9ad89a;         /* objective row */
    --note:#eef2ff; --note-b:#c7d2fe;
    --warn:#ffe6ea; --warn-b:#ff9db0;
  }
  html,body{margin:0;background:var(--bg);color:var(--ink);
            font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  main{max-width:1100px;margin:28px auto;padding:0 18px}
  h1{font-size:1.9rem;margin:.2rem 0 1rem}
  h2{margin:1.2rem 0 .6rem}
  h3{margin:1rem 0 .5rem}
  p.lead{color:var(--muted)}
  .card{background:#fff;border:1px solid var(--line);border-radius:10px;box-shadow:0 1px 0 rgba(0,0,0,.03);margin:.7rem 0}
  .hd{padding:10px 12px;border-bottom:1px solid var(--line);font-weight:600}
  .bd{padding:12px}
  .note{background:var(--note);border:1px solid var(--note-b);border-radius:8px;padding:10px 12px}
  .warn{background:var(--warn);border:1px solid var(--warn-b);border-radius:8px;padding:10px 12px}
  table{width:100%;border-collapse:collapse;margin:.6rem 0}
  th,td{border:1px solid var(--line);padding:6px 8px;text-align:right}
  th:first-child,td:first-child{text-align:left}
  .status{text-align:center;white-space:nowrap}
  .zrow td,.zrow th{background:var(--obj);font-weight:700;border-color:var(--obj-b)}
  .pivotcell{background:var(--pivot);border:2px solid var(--pivot-b);font-weight:700}
  .entercol{background:var(--enter);border:1px solid var(--enter-b)}
  code, .math{background:#f6f8fa;border:1px solid var(--line);padding:0 .25rem;border-radius:4px}
  .grid{display:grid;gap:12px}
  .grid.cols-2{grid-template-columns:1fr 1fr}
  .tiny{font-size:.92rem;color:var(--muted)}
  .step{padding:8px 10px;border-left:4px solid #cbd5e1;background:#fff;border:1px solid var(--line);border-radius:8px;margin:.5rem 0}
</style>
</head>
<body>
<main>

<h1>“Normalize Pivot Row” in the Simplex Method — Everything You Need</h1>
<p class="lead">
Normalizing the pivot row is the Gauss–Jordan operation that turns the pivot element into <b>1</b>,
so the entering variable’s column becomes a unit vector (1 in its own row, 0 elsewhere).
It’s essential for making the entering variable <b>basic</b> with value equal to the row’s RHS.
</p>

<!-- --------------------------------------------------------------- -->
<div class="card">
  <div class="hd">What does “Normalize pivot row” mean—algebraically?</div>
  <div class="bd">
    Suppose you chose the entering column <span class="math">e</span> and the leaving row <span class="math">k</span>.
    Let the tableau entry at (row k, col e) be the <b>pivot element</b> <span class="math">p</span>.
    <div class="note">
      <b>Normalize step:</b> divide <u>every</u> entry of the pivot row by <span class="math">p</span>.<br/>
      This makes the pivot cell exactly <b>1</b>, i.e., <span class="math">a_{ke} ← a_{ke} / p = 1</span>, and
      RHS of that row becomes the new value of the entering basic variable.
    </div>
    After normalization, eliminate the entering column from all other rows (including the objective row)
    by subtracting a multiple of the normalized pivot row. But <i>normalization comes first</i>.
  </div>
</div>

<!-- --------------------------------------------------------------- -->
<div class="card">
  <div class="hd">Why it’s necessary</div>
  <div class="bd">
    <ul>
      <li>It creates a <b>canonical (identity) column</b> for the entering variable, which encodes “this row solves for that variable”.</li>
      <li>It guarantees the entering variable’s <b>reduced cost becomes 0</b> after the column elimination step.</li>
      <li>Without normalization, you’d carry a scale factor around and the basis wouldn’t be in canonical form.</li>
    </ul>
  </div>
</div>

<!-- --------------------------------------------------------------- -->
<h2>How to do it — arithmetic recipe</h2>
<div class="grid cols-2">
  <div class="card">
    <div class="hd">Inputs</div>
    <div class="bd">
      <ul>
        <li>Pivot element <span class="math">p = a_{ke}</span>.</li>
        <li>Pivot row vector (including RHS and objective coefficient if you carry it there).</li>
      </ul>
    </div>
  </div>
  <div class="card">
    <div class="hd">Operation</div>
    <div class="bd">
      <ol>
        <li><b>Check</b> that <span class="math">|p| &gt; ε</span> (tolerance like 1e−12). If not, choose a different row or re-price.</li>
        <li><b>Divide</b> the whole pivot row by <span class="math">p</span>:
          <div class="note"><span class="math">Row_k ← Row_k / p</span></div>
        </li>
        <li>Now <span class="math">a_{ke}=1</span>, and the row expresses the entering variable as RHS minus a linear combo of all other columns.</li>
      </ol>
    </div>
  </div>
</div>

<!-- --------------------------------------------------------------- -->
<h2>Numerical mini-examples of normalization</h2>

<div class="card">
  <div class="hd">A) Negative pivot (common) — just divide by a negative</div>
  <div class="bd">
    <p>Before normalization: (entering column is <b>x₂</b>)</p>
    <table>
      <thead><tr><th>Basic</th><th>RHS</th><th>x₁</th><th class="entercol">x₂</th><th class="status">Status</th></tr></thead>
      <tbody>
        <tr>
          <td><b>x₁</b> (pivot row)</td><td>0</td><td>+1</td><td class="pivotcell">−3</td><td class="status">B</td>
        </tr>
      </tbody>
    </table>
    <div class="step">Normalize: divide the row by <span class="math">p=−3</span>.</div>
    <table>
      <thead><tr><th>Basic</th><th>RHS</th><th>x₁</th><th class="entercol">x₂</th><th class="status">Status</th></tr></thead>
      <tbody>
        <tr>
          <td><b>x₁</b> → will become <b>x₂</b> after relabel</td><td>0</td><td>−1/3</td><td class="pivotcell">+1</td><td class="status">row normalized</td>
        </tr>
      </tbody>
    </table>
    <p class="tiny">After this, you’d eliminate x₂ from all other rows. The sign of <i>p</i> is irrelevant—division fixes it.</p>
  </div>
</div>

<div class="card">
  <div class="hd">B) Fractional pivot</div>
  <div class="bd">
    <table>
      <thead><tr><th>Basic</th><th>RHS</th><th>x₁</th><th class="entercol">x₂</th><th>x₃</th></tr></thead>
      <tbody>
        <tr>
          <td>Row k</td><td>7/2</td><td>5/2</td><td class="pivotcell">3/4</td><td>−1/2</td>
        </tr>
      </tbody>
    </table>
    <div class="step">Normalize by <span class="math">p=3/4</span> (i.e., multiply row by 4/3):</div>
    <table>
      <thead><tr><th>Basic</th><th>RHS</th><th>x₁</th><th class="entercol">x₂</th><th>x₃</th></tr></thead>
      <tbody>
        <tr>
          <td>Row k</td><td>(7/2)/(3/4)=14/3</td><td>(5/2)/(3/4)=10/3</td><td class="pivotcell">1</td><td>(−1/2)/(3/4)=−2/3</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div class="card">
  <div class="hd">C) Very small pivot — detect and avoid</div>
  <div class="bd">
    <p>If <span class="math">|p| &lt; ε</span> (e.g., <span class="math">p=1e−15</span>), normalization will blow up coefficients and ruin numerics.</p>
    <div class="warn"><b>Best practices:</b>
      <ul>
        <li>Use a tolerance: reject pivots with <span class="math">|p| &lt; ε</span>.</li>
        <li>If many small candidates, consider scaling rows/cols or recomputing pricing.</li>
        <li>In sparse codes, prefer numerically stable nonzeros to maintain sparsity.</li>
      </ul>
    </div>
  </div>
</div>

<!-- --------------------------------------------------------------- -->
<h2>What happens to the RHS when you normalize?</h2>
<div class="card">
  <div class="bd">
    The pivot row’s RHS (call it <span class="math">b_k</span>) becomes <span class="math">b_k / p</span>.
    After normalization and column elimination, the entering variable’s value equals the final RHS of its row.
    <div class="note">
      In a degenerate pivot, the ART step <span class="math">θ=0</span>: the RHS will be unchanged even after elimination,
      so the point stays the same, but the <b>basis</b> (and reduced costs) change.
    </div>
  </div>
</div>

<!-- --------------------------------------------------------------- -->
<h2>Full mini walk-through (normalize + eliminate)</h2>
<div class="card">
  <div class="hd">Before pivot</div>
  <div class="bd">
    <table>
      <thead>
        <tr><th>Basic</th><th>RHS</th><th>x₁</th><th class="entercol">x₂</th><th>x₃</th></tr>
      </thead>
      <tbody>
        <tr>
          <td><b>x₁</b> (pivot row)</td><td>6</td><td>2</td><td class="pivotcell">−4</td><td>1</td>
        </tr>
        <tr class="zrow">
          <td><b>z</b></td><td><b>0</b></td><td>0</td><td><b>r(x₂)=−3</b></td><td>0</td>
        </tr>
      </tbody>
    </table>

    <div class="step"><b>Normalize pivot row:</b> divide by <span class="math">p=−4</span></div>
    <table>
      <thead>
        <tr><th>Basic</th><th>RHS</th><th>x₁</th><th class="entercol">x₂</th><th>x₃</th></tr>
      </thead>
      <tbody>
        <tr>
          <td>x₁ → (normalized)</td><td>6/(−4)=−1.5</td><td>2/(−4)=−0.5</td><td class="pivotcell">1</td><td>1/(−4)=−0.25</td>
        </tr>
      </tbody>
    </table>

    <div class="step"><b>Eliminate entering column elsewhere:</b> for each other row with coefficient <span class="math">c_i</span> in col x₂,<br/>
      do <span class="math">Row_i ← Row_i − c_i·(Row_k)</span>. For the objective row, <span class="math">c_z = −3</span>.
    </div>

    <table>
      <thead><tr><th>Row</th><th>New RHS</th><th>New x₁</th><th class="entercol">New x₂</th><th>New x₃</th></tr></thead>
      <tbody>
        <tr>
          <td><b>z</b></td>
          <td>0 − (−3)(−1.5) = −4.5</td>
          <td>0 − (−3)(−0.5) = −1.5</td>
          <td>−3 − (−3)(1) = 0</td>
          <td>0 − (−3)(−0.25) = −0.75</td>
        </tr>
      </tbody>
    </table>

    <p>Now the x₂ column is a unit vector. Relabel the pivot row to make <b>x₂</b> basic, and <b>x₁</b> becomes nonbasic.</p>
  </div>
</div>

<!-- --------------------------------------------------------------- -->
<h2>Edge cases and gotchas (specific to normalization)</h2>
<div class="card">
  <div class="bd">
    <ul>
      <li><b>Zero or near-zero pivot:</b> never divide by a tiny number—use a tolerance to reject it.</li>
      <li><b>Sign of pivot:</b> doesn’t matter; dividing by a negative flips all signs consistently.</li>
      <li><b>Big/small magnitudes:</b> consider row/column scaling to improve conditioning before normalization.</li>
      <li><b>Sparsity:</b> prefer pivot elements that keep the row sparse after division (important for large LPs).</li>
      <li><b>Multiple RHS (e.g., tracking shadow prices):</b> divide <u>every</u> RHS/auxiliary quantity in the row by <span class="math">p</span> too.</li>
      <li><b>Bounded simplex (LB/UB kept inside):</b> normalization is purely algebraic; the ART and status (LB/UB/B) logic happens before/after.</li>
    </ul>
  </div>
</div>

<!-- --------------------------------------------------------------- -->
<h2>Why normalization makes the entering reduced cost = 0</h2>
<div class="card">
  <div class="bd">
    Reduced costs are <span class="math">r_j = c_j − c_Bᵀ B⁻¹ a_j</span>. After the pivot, the entering column becomes part of <span class="math">B</span>,
    so its reduced cost is, by construction, <b>zero</b>. Normalization + elimination ensure the column is exactly the identity column for the new basis.
  </div>
</div>

<!-- --------------------------------------------------------------- -->
<h2>Normalization in degenerate pivots</h2>
<div class="card">
  <div class="bd">
    In a degenerate row pivot, the ART step is <span class="math">θ=0</span>. You still normalize the pivot row and eliminate the column.
    The point (values) and objective do not change; only the <b>basis</b> does. This can change reduced costs and allow progress next step.
  </div>
</div>

</main>
</body>
</html>
